<section
  id="{{ widget.id }}"
  class="widget widget-video"
  data-widget-id="{{ widget.id }}"
  data-widget-type="video"
>
  {%- comment -%} Calculate aspect ratio padding {%- endcomment -%}
  {%- assign aspect_padding = '56.25%' -%}
  {%- case widget.settings.aspect_ratio -%}
    {%- when '4:3' -%}
      {%- assign aspect_padding = '75%' -%}
    {%- when '21:9' -%}
      {%- assign aspect_padding = '42.86%' -%}
    {%- when '1:1' -%}
      {%- assign aspect_padding = '100%' -%}
  {%- endcase -%}

  <style>
    #{{ widget.id }} {
      & .video-container {
        position: relative;
        padding-block-end: {{ aspect_padding }};
        height: 0;
        overflow: hidden;
        background-color: var(--color-black);

        & video {
          position: absolute;
          inset-block-start: 0;
          inset-inline-start: 0;
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
      }

      & .video-placeholder {
        display: flex;
        align-items: center;
        justify-content: center;
        aspect-ratio: 16 / 9;
        background-color: var(--bg-secondary);
        border: var(--border-width-thin) solid var(--border-light);
        color: var(--text-muted);
        text-align: center;
        padding: var(--space-2xl);
      }
    }
  </style>

  <div class="widget-container">
    {% if widget.settings.title != blank or widget.settings.description != blank or widget.settings.eyebrow != blank %}
      <div class="widget-header">
        {% if widget.settings.eyebrow != blank %}
          <span class="widget-eyebrow">{{ widget.settings.eyebrow }}</span>
        {% endif %}
        {% if widget.settings.title != blank %}
          <h2 class="widget-headline">{{ widget.settings.title }}</h2>
        {% endif %}
        {% if widget.settings.description != blank %}
          <p class="widget-description">{{ widget.settings.description }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="widget-content">
      {% if widget.settings.video != blank %}
        <div class="video-container">
          <video
            src="{{ widget.settings.video | video: 'path' }}"
            title="{{ widget.settings.video | media_meta: 'title' }}"
            {% if widget.settings.controls %}controls{% endif %}
            {% if widget.settings.autoplay %}autoplay{% endif %}
            {% if widget.settings.muted %}muted{% endif %}
            {% if widget.settings.loop %}loop{% endif %}
            playsinline
            preload="metadata"
          >
            Your browser does not support the video tag.
          </video>
        </div>
      {% else %}
        <div class="video-placeholder">
          <p>Upload a video file to display it here</p>
        </div>
      {% endif %}
    </div>
  </div>
</section>
