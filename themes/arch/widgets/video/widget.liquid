<section
  id="{{ widget.id }}"
  class="widget widget-type-video widget-{{ widget.id }} color-scheme-{{ widget.settings.color_scheme }}"
  {% if widget.settings.color_scheme == 'highlight' %}
    style="--widget-bg-color: var(--bg-primary);"
  {% endif %}
  data-widget-id="{{ widget.id }}"
  data-widget-type="video"
  {% if widget.index != null %}data-widget-index="{{ widget.index }}"{% endif %}
>
  {%- comment -%} Calculate aspect ratio padding {%- endcomment -%}
  {%- assign aspect_padding = '56.25%' -%}
  {%- case widget.settings.aspect_ratio -%}
    {%- when '4:3' -%}
      {%- assign aspect_padding = '75%' -%}
    {%- when '21:9' -%}
      {%- assign aspect_padding = '42.86%' -%}
    {%- when '1:1' -%}
      {%- assign aspect_padding = '100%' -%}
  {%- endcase -%}

  <style>
    .widget-{{ widget.id }} {
      & .video-container {
        position: relative;
        padding-block-end: {{ aspect_padding }};
        height: 0;
        overflow: hidden;
        background-color: var(--color-black);

        & video {
          position: absolute;
          inset-block-start: 0;
          inset-inline-start: 0;
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
      }

      & .video-placeholder {
        display: flex;
        align-items: center;
        justify-content: center;
        aspect-ratio: 16 / 9;
        background-color: var(--bg-secondary);
        border: var(--border-width-thin) solid var(--border-color);
        text-align: center;
        padding: var(--space-2xl);
      }
    }
  </style>

  <div class="widget-container {% if widget.settings.color_scheme == 'highlight' %}widget-container-padded{% endif %}">
    {% if widget.settings.title != blank or widget.settings.description != blank or widget.settings.eyebrow != blank %}
      <div class="widget-header">
        {% assign header_delay = 0 %}
        {% if widget.settings.eyebrow != blank %}
          <span class="widget-eyebrow reveal reveal-up" style="--reveal-delay: {{ header_delay }}" data-setting="eyebrow">{{ widget.settings.eyebrow }}</span>
          {% assign header_delay = header_delay | plus: 1 %}
        {% endif %}
        {% if widget.settings.title != blank %}
          {% if widget.index == 1 %}
            <h1 class="widget-headline reveal reveal-up" style="--reveal-delay: {{ header_delay }}" data-setting="title">{{ widget.settings.title }}</h1>
          {% else %}
            <h2 class="widget-headline reveal reveal-up" style="--reveal-delay: {{ header_delay }}" data-setting="title">{{ widget.settings.title }}</h2>
          {% endif %}
          {% assign header_delay = header_delay | plus: 1 %}
        {% endif %}
        {% if widget.settings.description != blank %}
          <p class="widget-description reveal reveal-up" style="--reveal-delay: {{ header_delay }}" data-setting="description">{{ widget.settings.description }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="widget-content">
      {% if widget.settings.video != blank %}
        <div class="video-container reveal reveal-fade">
          <video
            src="{% video src: widget.settings.video, output: 'url' %}"
            title="{{ widget.settings.video | media_meta: 'title' }}"
            {% if widget.settings.controls %}controls{% endif %}
            {% if widget.settings.autoplay %}autoplay{% endif %}
            {% if widget.settings.muted %}muted{% endif %}
            {% if widget.settings.loop %}loop{% endif %}
            playsinline
            preload="metadata"
          >
            Your browser does not support the video tag.
          </video>
        </div>
      {% else %}
        <div class="video-placeholder">
          <p class="block-text block-text-muted">Upload a video file to display it here</p>
        </div>
      {% endif %}
    </div>
  </div>
</section>
