<section
  id="{{ widget.id }}"
  class="widget widget-contact widget-{{ widget.id }} {% if widget.settings.sidebar_position == 'left' %}layout-reverse{% endif %}"
  {% if widget.settings.background == 'secondary' %}
    style="--widget-bg-color: var(--bg-secondary);"
  {% endif %}
  data-widget-id="{{ widget.id }}"
  data-widget-type="contact-form"
  {% if widget.index != null %}data-widget-index="{{ widget.index }}"{% endif %}
>
  <style>
    .widget-{{ widget.id }} {
      & .contact-content {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--space-lg);
      }

      & .contact-form {
        display: flex;
        flex-direction: column;
        gap: var(--space-lg);
      }

      /* Contact Info Sidebar */
      & .contact-info {
        display: flex;
        flex-direction: column;
        gap: var(--space-xl);
      }

      & .contact-info-block {
        display: flex;
        flex-direction: column;
        gap: var(--space-sm);
      }

      & .contact-info-title {
        margin: 0;
      }

      & .contact-info-text {
        margin: 0;
      }

      & .contact-info-link {
        text-decoration: none;
        transition: color 0.3s;

        &:hover {
          text-decoration: underline;
        }
      }

      @media (min-width: 750px) {
        & .contact-content:not(.no-sidebar) {
          grid-template-columns: 7fr 3fr;
          gap: var(--space-3xl);
        }
      }

      /* Variant: Reverse Layout (sidebar left) */
      &.layout-reverse {
        @media (min-width: 750px) {
          & .contact-content:not(.no-sidebar) {
            grid-template-columns: 3fr 7fr;
          }

          & .contact-form {
            order: 2;
          }

          & .contact-info {
            order: 1;
          }
        }
      }
    }
  </style>

  <div class="widget-container {% if widget.settings.background == 'secondary' %}widget-container-padded{% endif %}">
    {% if widget.settings.title != blank or widget.settings.description != blank or widget.settings.eyebrow != blank %}
      <div class="widget-header">
        {% if widget.settings.eyebrow != blank %}
          <span class="widget-eyebrow" data-setting="eyebrow">{{ widget.settings.eyebrow }}</span>
        {% endif %}
        {% if widget.settings.title != blank %}
          <h2 class="widget-headline" data-setting="title">{{ widget.settings.title }}</h2>
        {% endif %}
        {% if widget.settings.description != blank %}
          <p class="widget-description" data-setting="description">{{ widget.settings.description }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="widget-content {% if widget.settings.show_sidebar %}widget-content-md{% else %}widget-content-sm{% endif %}">
      <div class="contact-content {% unless widget.settings.show_sidebar %}no-sidebar{% endunless %}">
        <!-- Contact Form -->
        <form
          class="contact-form"
          action="{{ widget.settings.form_action }}"
          method="{{ widget.settings.form_method }}"
        >
          {% for blockId in widget.blocksOrder %}
            {% assign block = widget.blocks[blockId] %}
            {% if block.type != 'info' %}
              {% assign field_id = widget.id | append: '-' | append: block.settings.name %}

              {% case block.type %}
                {% when 'input' %}
                  <div class="form-group" data-block-id="{{ blockId }}">
                    <label for="{{ field_id }}" class="form-label">
                      {{ block.settings.label -}}
                      {%- if block.settings.required %} *{% endif %}
                    </label>
                    <input
                      type="{{ block.settings.input_type }}"
                      id="{{ field_id }}"
                      name="{{ block.settings.name }}"
                      class="form-input"
                      {% if block.settings.placeholder != blank %}
                        placeholder="{{ block.settings.placeholder }}"
                      {% endif %}
                      {% if block.settings.required %}
                        required aria-required="true"
                      {% endif %}
                    >
                  </div>

                {% when 'textarea' %}
                  <div class="form-group" data-block-id="{{ blockId }}">
                    <label for="{{ field_id }}" class="form-label">
                      {{ block.settings.label -}}
                      {%- if block.settings.required %} *{% endif %}
                    </label>
                    <textarea
                      id="{{ field_id }}"
                      name="{{ block.settings.name }}"
                      class="form-textarea"
                      {% if block.settings.placeholder != blank %}
                        placeholder="{{ block.settings.placeholder }}"
                      {% endif %}
                      {% if block.settings.required %}
                        required aria-required="true"
                      {% endif %}
                    ></textarea>
                  </div>

                {% when 'dropdown' %}
                  <div class="form-group" data-block-id="{{ blockId }}">
                    <label for="{{ field_id }}" class="form-label">
                      {{ block.settings.label -}}
                      {%- if block.settings.required %} *{% endif %}
                    </label>
                    <select
                      id="{{ field_id }}"
                      name="{{ block.settings.name }}"
                      class="form-select"
                      {% if block.settings.required %}
                        required aria-required="true"
                      {% endif %}
                    >
                      <option value="">Select an option</option>
                      {% assign options = block.settings.options | split: '
' %}
                      {% for option in options %}
                        {% assign trimmed_option = option | strip %}
                        {% if trimmed_option != blank %}
                          <option value="{{ trimmed_option | handleize }}">{{ trimmed_option }}</option>
                        {% endif %}
                      {% endfor %}
                    </select>
                  </div>

                {% when 'checkbox' %}
                  <div class="form-group" data-block-id="{{ blockId }}">
                    <div class="form-checkbox-group">
                      <input
                        type="checkbox"
                        id="{{ field_id }}"
                        name="{{ block.settings.name }}"
                        class="form-checkbox"
                        {% if block.settings.required %}
                          required aria-required="true"
                        {% endif %}
                      >
                      <label for="{{ field_id }}" class="form-checkbox-label">
                        {{ block.settings.label -}}
                        {%- if block.settings.required %} *{% endif %}
                      </label>
                    </div>
                  </div>

                {% when 'submit' %}
                  <div class="form-group" data-block-id="{{ blockId }}">
                    <button type="submit" class="widget-button widget-button-primary">
                      {{ block.settings.text }}
                    </button>
                  </div>
              {% endcase %}
            {% endif %}
          {% endfor %}
        </form>

        {% if widget.settings.show_sidebar %}
          <!-- Contact Information Sidebar -->
          <div class="contact-info">
            {% for blockId in widget.blocksOrder %}
              {% assign block = widget.blocks[blockId] %}
              {% if block.type == 'info' %}
                <div class="contact-info-block" data-block-id="{{ blockId }}">
                  {% if block.settings.title != blank %}
                    <h3 class="contact-info-title block-text block-text-lg block-text-heading" data-setting="title">{{ block.settings.title }}</h3>
                  {% endif %}
                  {% if block.settings.text != blank %}
                    <p class="contact-info-text block-text block-text-base block-text-muted" data-setting="text">
                      {{ block.settings.text }}
                    </p>
                  {% endif %}
                </div>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>
