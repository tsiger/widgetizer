<section
	class="basic-text"
	data-widget-id="{{ widget.id }}"
	data-widget-type="basic-text"
>
	{% asset "basic-text.css" %}
	{% asset "basic-text.js" %}
	<style>
		#{{ widget.id }}.basic-text__container {
			background-color: {{ widget.settings.backgroundColor }};
			padding: {{ widget.settings.padding }}px;
		}

		#{{ widget.id }} .basic-text__heading {
			font-size: {{ widget.settings.headingSize }}px;
			margin-bottom: 1rem;
			color: {{ widget.settings.headingColor }};
			text-align: {{ widget.settings.textAlignment }};
		}

		#{{ widget.id }} .basic-text__content {
			font-size: 1rem;
			line-height: 1.5;
			color: {{ widget.settings.textColor }};
		}

		#{{ widget.id }} .basic-text__blocks {
			margin-top: 20px;
			display: grid;
			grid-template-columns: repeat({{ widget.settings.columnsCount|default: 1 }}, 1fr);
			gap: {{ widget.settings.blockSpacing|default: 20 }}px;
		}

		#{{ widget.id }} .basic-text__block {
			padding: 20px;
			background: {{ widget.settings.blockBackground|default: '#ffffff' }};
			border: 1px solid {{ widget.settings.customBorder|default: '#000000' }};
		}

		#{{ widget.id }} .basic-text__block-title {
			font-size: 1.25rem;
			font-weight: bold;
			margin-bottom: 12px;
			color: {{ widget.settings.headingColor }};
		}

		#{{ widget.id }} .basic-text__block-content {
			color: {{ widget.settings.textColor }};
			font-size: 1rem;
			line-height: 1.5;
		}

		#{{ widget.id }} .basic-text__block-image {
			width: 100%;
			height: auto;
			margin-bottom: 12px;
		}
	</style>

	<div id="{{ widget.id }}" class="basic-text__container">

		Show sidebar: {{ theme.layout.show_header }}<br>

		{% if widget.settings.showImage %}
			true
		{% else %}
			false
		{% endif %}

		{% if widget.settings.widgetImage != blank %}
			{{ widget.settings.widgetImage | image: size: 'medium', class: 'basic-text__widget-image' }}
		{% endif %}

		{% if widget.settings.heading != blank %}
			<h2 class="basic-text__heading" data-setting="heading">
				{{ widget.settings.heading }}
			</h2>
		{% endif %}

		<div class="basic-text__content" data-setting="content">
			{% if widget.settings.content != blank %}
				{{ widget.settings.content }}
			{% endif %}
		</div>

		{% if widget.blocks.size > 0 %}
			<div class="basic-text__blocks">
				{% for blockId in widget.blocksOrder %}
					{% assign block = widget.blocks[blockId] %}
					<div
						class="basic-text__block"
						data-block-id="{{ blockId }}"
						data-block-type="{{ block.type }}"
						style="background-color: {{ block.settings.customBackground }};"
					>

						{% if block.type == 'content-block' %}

							<h4>Content Block Type</h4>
							<h3 class="basic-text__block-title">{{ block.settings.title }}</h3>
							{% if block.settings.blockImage != blank %}
								{{ block.settings.blockImage | image: size: 'small', class: 'basic-text__block-image' }}
							{% endif %}
							<div class="basic-text__block-content">
								{{ block.settings.content }}
							</div>

						{% elsif block.type == 'other-block' %}

							<h4>Other Block Type</h4>
							<h3 class="basic-text__block-title" style="font-style: italic;">{{ block.settings.title }}</h3>
							{% if block.settings.blockImage != blank %}
								{{ block.settings.blockImage | image: size: 'small', class: 'basic-text__block-image small-image' }}
							{% endif %}

						{% else %}

							<h4>Unknown Block Type: {{ block.type }}</h4>
							<p>Cannot render this block type.</p>

						{% endif %}

					</div>
				{% endfor %}
			</div>
		{% else %}
			<div style="border: 1px solid blue; padding: 10px;">
				DEBUG: Inside else branch. No blocks object found or it is empty/falsy.
			</div>
		{% endif %}
	</div>


	<script type="application/json" data-widget-schema>
		{
			"type": "basic-text",
			"displayName": "Basic Text",
			"settings": [
				{
					"type": "checkbox",
					"id": "showImage",
					"label": "Show Image",
					"description": "Show the image",
					"default": true
				},
				{
					"type": "image",
					"id": "widgetImage",
					"label": "Image",
					"description": "Image for the basic text",
					"default": ""
				},
				{
					"type": "text",
					"id": "heading",
					"label": "Heading",
					"description": "Main heading text",
					"default": "Default heading"
				},
				{
					"type": "textarea",
					"id": "content",
					"label": "Content",
					"description": "Main paragraph text",
					"default": "This is a simple text section with a heading and paragraph."
				},
				{
					"type": "color",
					"id": "backgroundColor",
					"label": "Background Color",
					"description": "Background color of the section",
					"default": "#ffffff"
				},
				{
					"type": "color",
					"id": "headingColor",
					"label": "Heading Color",
					"description": "Color of the heading text",
					"default": "#333333"
				},
				{
					"type": "color",
					"id": "textColor",
					"label": "Text Color",
					"description": "Color of the main content text",
					"default": "#666666"
				},
				{
					"type": "range",
					"id": "headingSize",
					"label": "Heading Size",
					"description": "Size of the heading in pixels",
					"default": 20,
					"min": 16,
					"max": 72,
					"step": 1
				},
				{
					"type": "range",
					"id": "padding",
					"label": "Padding",
					"description": "Padding around the content in pixels",
					"default": 20,
					"min": 0,
					"max": 100,
					"step": 5
				},
				{
					"type": "range",
					"id": "columnsCount",
					"label": "Columns",
					"description": "Number of columns for blocks",
					"default": 3,
					"min": 1,
					"max": 4,
					"step": 1
				},
				{
					"type": "range",
					"id": "blockSpacing",
					"label": "Block Spacing",
					"description": "Space between blocks in pixels",
					"default": 20,
					"min": 0,
					"max": 60,
					"step": 4
				},
				{
					"type": "color",
					"id": "blockBackground",
					"label": "Block Background",
					"description": "Background color for blocks",
					"default": "#ffffff"
				},
				{
					"type": "select",
					"id": "textAlignment",
					"label": "Text Alignment",
					"description": "Alignment of the heading text",
					"default": "left",
					"options": [
						{ "value": "left", "label": "Left" },
						{ "value": "center", "label": "Center" },
						{ "value": "right", "label": "Right" }
					]
				}
			],
			"blocks": [
				{
					"type": "content-block",
					"displayName": "Content Block",
					"settings": [
						{
							"type": "image",
							"id": "blockImage",
							"label": "Image",
							"description": "Image for the block",
							"default": ""
						},
						{
							"type": "text",
							"id": "title",
							"label": "Title",
							"description": "Block title",
							"default": "Block Title"
						},
						{
							"type": "textarea",
							"id": "content",
							"label": "Content",
							"description": "Block content",
							"default": "Add your content here"
						},
						{
							"type": "color",
							"id": "customBackground",
							"label": "Block Background",
							"description": "Background color for blocks",
							"default": "#ffffff"
						},
						{
							"type": "color",
							"id": "customBorder",
							"label": "Block Border",
							"description": "Border color for blocks",
							"default": "#000000"
						}
					]
				},
				{
					"type": "other-block",
					"displayName": "Other Block",
					"settings": [
						{
							"type": "image",
							"id": "blockImage",
							"label": "Image",
							"description": "Image for the block",
							"default": ""
						},
						{
							"type": "text",
							"id": "title",
							"label": "Title",
							"description": "Block title",
							"default": "Block Title"
						},
						{
							"type": "color",
							"id": "customBackground",
							"label": "Block Background",
							"description": "Background color for blocks",
							"default": "#ffffff"
						}
					]
				}
			]
		}
	</script>
</section>
